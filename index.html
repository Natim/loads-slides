<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Loads — DjangoCon EU</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="mozilla/css/print.css">
    <link rel="stylesheet" media="screen, projection" href="mozilla/css/screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="mozilla/js/slides.js"></script>
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Loads — DjangoCon EU</h1></header>
            
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              1/8
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            
            <section><img alt="logo.jpg" src="logo.jpg" />
<p class="center"><strong>Conterit Omnia Tua Application</strong></p>
<p class="center">Rémy Hubscher - <a class="reference external" href="mailto:natim&#64;mozilla.com">natim&#64;mozilla.com</a> - &#64;natim</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              2/8
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>What is Loads for?</h1></header>
            
            
            <section><p>Loads is there to answer this kind of questions:</p>
<ul class="simple">
<li>Is your architecture ready to handle your user loads?</li>
<li>Does it break under pressure?</li>
<li>How far can you push your server architecture?</li>
</ul>
<p>It let you run a load test:</p>
<ul class="simple">
<li>From a computer</li>
<li>From a local cluster</li>
<li>From a cloud cluster</li>
</ul>
<p>And it is always the same simple command:</p>
<pre class="literal-block">
$ loads-runner --ssh user&#64;loads-master loadtests.TestWebSite.test_es
</pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              3/8
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>How to write a test for loads</h1></header>
            
            
            <section><p>You can just write a Python unittest:</p>
<pre><span class="kn">from</span> <span class="nn">loads.case</span> <span class="kn">import</span> <span class="n">TestCase</span>

<span class="k">class</span> <span class="nc">TestWebSite</span><span class="p">(</span><span class="n">TestCase</span><span class="p">):</span>

    <span class="k">def</span> <span class="nf">test_es</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">session</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;http://localhost:9200&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">status_code</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">test_island</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s">&#39;island&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">test_something</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">assertTrue</span><span class="p">(</span><span class="s">&#39;island&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">app</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s">&#39;/&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">incr_counter</span><span class="p">(</span><span class="s">&#39;island-was-there&#39;</span><span class="p">)</span>
</pre>
<ul class="simple">
<li><cite>self.session</cite> is a wrapper around <cite>requests.Session</cite> that will handle the load to a specific endpoint.</li>
<li><cite>self.app</cite> is a similar wrapper around <cite>WebTest</cite> so that you can run the same tests on different endpoints or even use a functional test as loadtest.</li>
<li>You can load test websockets</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              4/8
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Deploy a cluster</h1></header>
            
            
            <section><img alt="loads.jpg" src="loads.jpg" />
<ul class="simple">
<li>You need to start a loads-broker on you cluster master.</li>
<li>You need to start a loads-agent per node.</li>
</ul>
<p>We use <cite>circus</cite> to monitor <cite>loads-broker</cite> and <cite>loads-agent</cite> processes.</p>
<p>You can use loads-runner with command line arguments as well as using a configuration file.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              5/8
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Monitor your cluster</h1></header>
            
            
            <section><p>There is a web dashboard that can show you the status of your cluster in real-time:</p>
<img alt="loads-web.jpg" src="loads-web.jpg" /></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              6/8
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Results</h1></header>
            
            
            <section><pre><span class="gp">$</span> loads-runner loadtests.TestWebSite.test_something <span class="se">\</span>
<span class="go">        --include-file loadstests.py \</span>
<span class="go">        -u 200 --server-url http://2014.djangocon.eu</span>
<span class="go">[==============================================================] 100%</span>
<span class="go">Duration: 2.87 seconds</span>
<span class="go">Hits: 200</span>
<span class="go">Started: 2014-05-09 16:13:38.219595</span>
<span class="go">Approximate Average RPS: 69</span>
<span class="go">Average request time: 0.58s</span>
<span class="go">Opened web sockets: 0</span>
<span class="go">Bytes received via web sockets : 0</span>

<span class="go">Success: 200</span>
<span class="go">Errors: 0</span>
<span class="go">Failures: 0</span>

<span class="go">Slowest URL: http://178.32.28.121:80/ Average Request Time: 0.5801773</span>
<span class="go">Stats by URLs:</span>
<span class="go">- http://178.32.28.121:80/</span>
<span class="go">        Average request time: 0.5801773 Hits success rate: 1.0</span>
<span class="go">Custom metrics:</span>
<span class="go">- island-was-there : 200</span>
</pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              7/8
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: index.rst -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>The future of loads</h1></header>
            
            
            <section><img alt="loads2.jpg" src="loads2.jpg" />
<ul class="simple">
<li>We are improving the architecture to reduce the bottleneck between
<cite>loads-broker</cite> and <cite>loads-agent</cite> with a centralized database in the
middle.</li>
<li>We are building a <tt class="docutils literal"><span class="pre">loads-runner</span></tt> interface for other languages (go, node, etc.)</li>
</ul></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="index.rst">index.rst</a>
            </aside>
            
            <aside class="page_number">
              8/8
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">Loads — DjangoCon EU</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">-</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">What is Loads for?</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">How to write a test for loads</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">Deploy a cluster</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">Monitor your cluster</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">Results</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">The future of loads</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>